<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chemistry Game Show</title>

    <!-- Embedded CSS Styles -->
    <style>
        /* Use the imported Lato font */
        body {
            font-family: 'Lato', sans-serif;
            background-color: #eef2f7;
            /* Light, cool background */
            color: #333;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        .container {
            background-color: #ffffff;
            /* White container background */
            padding: 30px;
            border-radius: 8px;
            /* Subtle rounding */
            text-align: center;
            max-width: 650px;
            /* Wider container */
            width: 100%;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
            /* Clean shadow */
        }

        #lesson-selection.container {
            padding: 40px 30px;
        }

        #lesson-selection h2 {
            color: #1a2a6c;
            /* Deep blue */
            margin-bottom: 30px;
            font-size: 2.2em;
            font-weight: 900;
            /* Lato Black */
        }

        .action-button {
            background-color: #4a69bd;
            /* Muted blue */
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1.1em;
            border-radius: 5px;
            cursor: pointer;
            margin: 8px;
            transition: background-color 0.2s ease, transform 0.1s ease;
            font-weight: 700;
            /* Lato Bold */
            text-transform: uppercase;
        }

        .action-button:hover:not(:disabled) {
            background-color: #3b5998;
            /* Darker blue on hover */
            transform: translateY(-2px);
        }

        .action-button:active:not(:disabled) {
            transform: translateY(0);
        }

        .action-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Specific style for the skip button */
        #skip-button {
            background-color: #6c757d;
            /* Muted grey */
            margin-top: 15px;
            /* Space above skip button */
            margin-bottom: 15px;
            /* Space below skip button before separator/next */
        }

        #skip-button:hover:not(:disabled) {
            background-color: #5a6268;
            /* Darker grey on hover */
        }

        /* Style for the "Add to Remember" button */
        #add-to-remember-button {
            background-color: #ffc107;
            /* Orange/Yellow */
            color: #343a40;
            /* Dark text */
            font-size: 0.9em;
            /* Slightly smaller */
            padding: 8px 15px;
            margin-top: 15px;
            margin-bottom: 10px;
            border-radius: 5px;
        }

        #add-to-remember-button:hover:not(:disabled) {
            background-color: #e0a800;
            /* Darker orange */
        }

        #add-to-remember-button:disabled {
            /* Use a lighter version of its own color */
            background-color: #cccccc; /* Grey color for disabled remember button */
            color: #666; /* Dark grey text */
            cursor: not-allowed;
        }

        #game-title {
            color: #1a2a6c;
            /* Deep blue */
            margin-bottom: 15px;
            /* Less margin above counter */
            font-size: 2em;
            font-weight: 900;
        }

        .question-counter {
            font-size: 1em;
            color: #666;
            margin-bottom: 25px;
            /* Space below counter */
            font-weight: 400;
            /* Lato Regular */
        }

        #question-area {
            margin-bottom: 20px;
        }

        #question-text {
            font-size: 1.3em;
            margin-bottom: 20px;
            font-weight: 700;
            /* Lato Bold */
            line-height: 1.5;
            color: #444;
            text-align: left;
            /* Align question text left */
        }

        #answer-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
            /* Add margin below answer buttons */
        }

        .answer-button {
            background-color: #f0f0f0;
            /* Light grey button */
            color: #333;
            border: 1px solid #ddd;
            padding: 12px 15px;
            font-size: 1em;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s ease, border-color 0.2s ease;
            text-align: left;
            word-wrap: break-word;
            font-weight: 400;
        }

        .answer-button:hover:not(:disabled) {
            background-color: #e0e0e0;
            /* Slightly darker grey on hover */
            border-color: #ccc;
        }

        .answer-button:disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }

        /* Visual feedback on answer buttons */
        .answer-button.correct {
            background-color: #4CAF50;
            /* Green */
            border-color: #4CAF50;
            color: white;
            font-weight: 700;
        }

        .answer-button.incorrect {
            background-color: #f44336;
            /* Red */
            border-color: #f44336;
            color: white;
            font-weight: 700;
        }

        #feedback {
            margin-top: 20px;
            font-size: 1.1em;
            min-height: 1.4em;
            font-weight: 700;
            color: #333;
            /* Neutral color, feedback color set by JS */
        }

        #explanation-area {
            margin-top: 15px;
            padding: 15px;
            background-color: #e8f5e9;
            /* Very light green for explanation */
            border: 1px solid #c8e6c9;
            /* Light green border */
            border-radius: 5px;
            text-align: left;
            color: #2e7d32;
            /* Dark green text */
            font-size: 0.95em;
            line-height: 1.5;
            opacity: 0;
            /* Start hidden */
            transform: translateY(10px);
            /* Start slightly lower */
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
            /* Animation */
        }

        #explanation-area.visible {
            /* Class added by JS */
            opacity: 1;
            transform: translateY(0);
        }


        #explanation-area h3 {
            margin-top: 0;
            margin-bottom: 8px;
            font-size: 1em;
            font-weight: 700;
            color: #1b5e20;
            /* Even darker green */
        }

        #score-area {
            margin-top: 20px;
            font-size: 1.1em;
            color: #1a2a6c;
            /* Deep blue */
            font-weight: 700;
        }

        .separator {
            border: none;
            border-top: 1px solid #eee;
            /* Very light solid line */
            height: 1px;
            margin: 20px 0;
        }

        #final-score {
            margin-top: 20px;
            font-size: 1.2em;
        }

        #final-score h2 {
            color: #1a2a6c;
            /* Deep blue */
            margin-bottom: 10px;
            font-weight: 900;
        }

        #final-score p {
            margin-bottom: 15px;
            font-weight: 700;
        }

        #final-score .action-button {
            margin-top: 15px;
            /* Less space above final score buttons */
        }


        #quote-area {
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px solid #eee;
            /* Very light solid line */
            color: #6c757d;
            /* Muted grey text */
            font-size: 0.9em;
            font-style: italic;
            font-weight: 400;
        }

        #current-quote {
            margin: 0;
            line-height: 1.4;
        }

        .hidden {
            display: none;
        }
    </style>

    <!-- Link to Google Fonts (Lato) -->
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&display=swap" rel="stylesheet">
    <!-- jsPDF library for PDF generation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>

<body>
    <div id="lesson-selection" class="container">
        <h2>Choose a Lesson</h2>
        <!-- Update button texts to match the new lessons -->
        <!-- <button id="chemistry-bonds-button" class="action-button">Bonds and Forms of Molecules (16 Questions)</button> -->
        <!-- Keep other buttons hidden or remove them if only one lesson -->
        <!-- <button id="other-lesson-button" class="action-button hidden">Another Lesson</button> -->
    </div>

    <div class="game-container container hidden">
        <h1 id="game-title">Math (Application) Game Show!</h1>
        <div class="question-counter">Question <span id="current-q-num">0</span> of <span id="total-q-num">0</span>
        </div>

        <div id="question-area">
            <p id="question-text">Loading question...</p>
            <div id="answer-buttons">
                <!-- Answer buttons will be added here by JavaScript -->
            </div>
        </div>

        <div id="feedback">
            <!-- Feedback message (Correct/Incorrect) will appear here -->
        </div>

        <div id="explanation-area" class="hidden">
            <h3>Explanation:</h3>
            <p id="explanation-text"></p>
        </div>

        <!-- Add the "Add to Remember" button here -->
        <button id="add-to-remember-button" class="action-button hidden">Add to Remember List</button>


        <div id="score-area">
            Score: <span id="score">0</span>
        </div>

        <hr class="separator">

        <!-- Add the Skip button -->
        <button id="skip-button" class="action-button">Skip Question</button>

        <button id="next-button" class="action-button hidden">Next Question</button>

        <div id="final-score" class="hidden">
            <h2>Game Over!</h2>
            <p>Your final score for this lesson is: <span id="final-score-text">0</span> / <span
                    id="final-total-text">0</span></p>
            <button id="download-mistakes-pdf" class="action-button">Download Review PDF</button>
            <!-- Add the "Export All" button here -->
            <button id="export-all-pdf-button" class="action-button">Export All Questions with Answers</button>
            <button id="restart-button" class="action-button">Choose Another Lesson</button>
        </div>

        <div id="quote-area">
            <p id="current-quote"></p>
        </div>
    </div>

    <!-- Embedded JavaScript -->
    <script>
        // Define the lesson topic(s) based on the new PDF

const Topics = {
    ALKALI_METALS: 'Alkali Metals'
};

const allQuestions = [
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 1,
        question: "Each of the following represents the electron configuration of an alkali metal, except .........",
        options: [
            "a) 2, 1",
            "b) [Ne], 4s¹",
            "c) [Ar], 4s², 3d¹⁰, 4p⁶, 5s¹",
            "d) [Xe], 6s¹"
        ],
        correctAnswer: 1,
        correctAnswerText: "b) [Ne], 4s¹",
        explanation: "Alkali metals are Group 1 elements with a valence electron configuration of ns¹. Option a) 2, 1 represents 1s² 2s¹ (Lithium). Option c) [Ar], 4s², 3d¹⁰, 4p⁶, 5s¹ is equivalent to [Kr] 5s¹ (Rubidium). Option d) [Xe], 6s¹ represents Cesium. Option b) [Ne], 4s¹ does not represent a correct ground state electron configuration for an alkali metal, as electrons fill the 3s and 3p orbitals before the 4s orbital. This configuration does not fit the ns¹ pattern for alkali metals where the core is the nearest noble gas.",
        page: 107,
        section: "Abundance of alkali metals in nature"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 2,
        question: "Which of the following represents a crystal of rock salt ?",
        options: [
            "a) [Diagram a]",
            "b) [Diagram b]",
            "c) [Diagram c]",
            "d) [Diagram d]"
        ],
        correctAnswer: 3,
        correctAnswerText: "d) [Diagram d]",
        explanation: "Rock salt (NaCl) forms a cubic crystal lattice structure where Na⁺ and Cl⁻ ions are arranged in an alternating, regular pattern. Diagram d shows this characteristic cubic arrangement of positive and negative ions.",
        page: 107,
        section: "Abundance of alkali metals in nature"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 3,
        question: "The molecular formula of carnallite is .........",
        options: [
            "a) ClH₁₂KMgO",
            "b) Cl₃H₁₂KMgO₆",
            "c) Cl₃H₂KMgO",
            "d) KCl.MgCl.6H₂O"
        ],
        correctAnswer: 1,
        correctAnswerText: "b) Cl₃H₁₂KMgO₆",
        explanation: "Carnallite is a hydrated double salt with the chemical formula KCl·MgCl₂·6H₂O. Option b) Cl₃H₁₂KMgO₆ is an alternative way of writing the elements present in KCl·MgCl₂·6H₂O (K:1, Mg:1, Cl:3, O:6, H:12). Option d) is incorrect as magnesium chloride is MgCl₂, not MgCl.",
        page: 107,
        section: "Abundance of alkali metals in nature"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 4,
        question: "A sample of francium has a mass equals 20 mg, its mass after a period of time becomes .........",
        options: [
            "a) 20 mg",
            "b) more than 20 mg",
            "c) less than 20 mg",
            "d) double its value."
        ],
        correctAnswer: 2,
        correctAnswerText: "c) less than 20 mg",
        explanation: "Francium (Fr) is a radioactive alkali metal. Radioactive isotopes undergo nuclear decay, converting into other elements and emitting particles, which results in a decrease in the total mass of the original substance over time. Therefore, the mass of a sample of francium will decrease after a period of time.",
        page: 107,
        section: "Abundance of alkali metals in nature"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 5,
        question: "The chemically active metal .........",
        options: [
            "a) loses its valence electrons easily.",
            "b) forms unstable compounds.",
            "c) burns in air easily forming an acidic oxide.",
            "d) forms an oxide which is easily reduced by carbon."
        ],
        correctAnswer: 0,
        correctAnswerText: "a) loses its valence electrons easily.",
        explanation: "Chemically active metals, particularly alkali metals which are the most active, readily lose their valence electron(s) due to low ionization energy (as implied by question 6 and 10, and explicitly stated as strong reducing agents in question 11d). They form stable ionic compounds, their normal oxides are basic, and their oxides are difficult to reduce.",
        page: 107,
        section: "General properties of alkali metals"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 6,
        question: "It is not normal for sodium to exist in the oxidation state +2, because of its .........",
        options: [
            "a) high first ionization potential.",
            "b) high second ionization potential.",
            "c) large ionic radius.",
            "d) high electronegativity."
        ],
        correctAnswer: 1,
        correctAnswerText: "b) high second ionization potential.",
        explanation: "Sodium (Na) has one valence electron in the 3s orbital ([Ne] 3s¹). It easily loses this electron to form Na⁺ (oxidation state +1). The first ionization potential is low. However, removing a second electron requires breaking into the stable noble gas electron configuration of Na⁺ ([Ne]), which requires a very high amount of energy, i.e., a very high second ionization potential. This makes the +2 oxidation state unstable and not normal for sodium.",
        page: 108,
        section: "General properties of alkali metals"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 7,
        question: "Alkali metals are characterized by their large .........",
        options: [
            "a) densities.",
            "b) ionization potentials.",
            "c) atomic radii.",
            "d) electronegativities."
        ],
        correctAnswer: 2,
        correctAnswerText: "c) atomic radii.",
        explanation: "Alkali metals are located in Group 1 of the periodic table and have the largest atomic radii within their respective periods. They also have the lowest ionization potentials and lowest electronegativities in their periods. Their densities are relatively low compared to other metals, and not consistently large (Li, Na, K are less dense than water).",
        page: 108,
        section: "General properties of alkali metals"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 8,
        question: "The similarity of the chemical properties of the alkali metals is attributed to that .........",
        options: [
            "a) they all have the same electron configuration of the nearest noble gas.",
            "b) the valence electron of each of them has the same four quantum numbers.",
            "c) the valence electron of each of them has the same energy.",
            "d) the valence shell of each of them contains one electron."
        ],
        correctAnswer: 3,
        correctAnswerText: "d) the valence shell of each of them contains one electron.",
        explanation: "Elements in the same group of the periodic table exhibit similar chemical properties primarily because they have the same number of valence electrons and similar valence electron configurations. All alkali metals are in Group 1 and have one electron in their outermost (valence) shell (ns¹). This common valence electron structure dictates their chemical behavior, such as readily losing this electron to form +1 ions.",
        page: 108,
        section: "General properties of alkali metals"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 9,
        question: "By comparing cesium and potassium, it is concluded that cesium .........",
        options: [
            "a) has less atomic mass.",
            "b) has larger atomic size.",
            "c) has lower ability to be ionized.",
            "d) is less active."
        ],
        correctAnswer: 1,
        correctAnswerText: "b) has larger atomic size.",
        explanation: "Cesium (Cs) is located below Potassium (K) in Group 1 of the periodic table. Moving down Group 1, atomic mass increases, atomic size (radius) increases, ionization energy decreases (meaning higher ability to be ionized), and chemical reactivity increases. Therefore, Cesium has a larger atomic size, higher atomic mass, higher ability to be ionized, and is more active than Potassium.",
        page: 108,
        section: "General properties of alkali metals"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 10,
        question: "Which of the following elements loses its valence electron most easily ?",
        options: [
            "a) Li",
            "b) Na",
            "c) K",
            "d) Cs"
        ],
        correctAnswer: 3,
        correctAnswerText: "d) Cs",
        explanation: "The ease with which an element loses its valence electron is measured by its ionization energy. Alkali metals have low ionization energies, which decrease down the group. Among the given options (Li, Na, K, Cs), Cesium (Cs) is lowest in the group and therefore has the lowest ionization energy, meaning it loses its valence electron most easily. This also corresponds to increasing reactivity down the group.",
        page: 108,
        section: "General properties of alkali metals"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 11,
        question: "Each of the following statements is correct, except .........",
        options: [
            "a) alkali metals are similar in their electronegativities.",
            "b) lithium properties differ from some of magnesium properties.",
            "c) photoelectric phenomenon of alkali metals increases by increasing the atomic number.",
            "d) alkali metals are very strong reducing agents."
        ],
        correctAnswer: 0,
        correctAnswerText: "a) alkali metals are similar in their electronegativities.",
        explanation: "Statement b) is correct due to the diagonal relationship between Li and Mg. Statement c) is correct because ionization energy decreases down the group, making it easier to remove electrons (photoelectric effect). Statement d) is correct because alkali metals easily lose electrons, acting as strong reducing agents. Statement a) is incorrect; while all alkali metals have low electronegativity, there is a significant decrease down the group (e.g., Li 0.98, Cs 0.79), making them not particularly 'similar' compared to other properties or variations across the periodic table.",
        page: 108,
        section: "General properties of alkali metals"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 12,
        question: "Which of the following salts its cation yields a yellowish green colour in the dry test ?",
        options: [
            "a) NaCl",
            "b) LiCl",
            "c) BaCO₃",
            "d) K₂CO₃"
        ],
        correctAnswer: 2,
        correctAnswerText: "c) BaCO₃",
        explanation: "The dry test (flame test) is used to identify certain metal cations by the characteristic color they impart to a flame. Na⁺ gives a yellow flame. Li⁺ gives a red flame. K⁺ gives a lilac/violet flame. Ba²⁺ gives a yellowish-green or pale green flame. The salt BaCO₃ contains the Ba²⁺ cation, which produces a yellowish-green color in the flame test.",
        page: 108,
        section: null // General knowledge related to metal properties
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 13,
        question: "When lithium reacts with nitrogen of the atmospheric air by heating, then water is added to the product, a gas evolves which is .........",
        options: [
            "a) oxygen.",
            "b) hydrogen.",
            "c) nitric oxide.",
            "d) ammonia."
        ],
        correctAnswer: 3,
        correctAnswerText: "d) ammonia.",
        explanation: "Lithium is the only alkali metal that reacts directly with nitrogen gas upon heating to form a nitride (Li₃N): 6Li(s) + N₂(g) → 2Li₃N(s). Metal nitrides, including Li₃N, react with water in a hydrolysis reaction to produce the metal hydroxide and ammonia gas: Li₃N(s) + 3H₂O(l) → 3LiOH(aq) + NH₃(g). Therefore, adding water to the product (Li₃N) evolves ammonia gas.",
        page: 108,
        section: null // Reaction with nitrogen and hydrolysis of nitride
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 14,
        question: "Which of these hydroxides is the most basic ?",
        options: [
            "a) NaOH",
            "b) LiOH",
            "c) RbOH",
            "d) KOH"
        ],
        correctAnswer: 2,
        correctAnswerText: "c) RbOH",
        explanation: "Alkali metal hydroxides are strong bases. The basic strength of alkali metal hydroxides increases down the group as the ionic radius of the metal increases and the bond between the metal cation and the hydroxide anion becomes weaker, leading to easier dissociation of OH⁻. The order of increasing basic strength is LiOH < NaOH < KOH < RbOH < CsOH. Among the given options, RbOH is furthest down the group (below Li, Na, and K) and is therefore the most basic.",
        page: 108,
        section: "General properties of alkali metals"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 15,
        question: "The combination of sodium with oxygen produces an oxide containing the ion .........",
        options: [
            "a) O⁺",
            "b) O₂²⁻",
            "c) O⁻",
            "d) O₂⁻"
        ],
        correctAnswer: 2,
        correctAnswerText: "c) O⁻",
        explanation: "Alkali metals react with oxygen to form various oxides depending on the metal and conditions: normal oxides (containing O²⁻), peroxides (containing O₂²⁻), and superoxides (containing O₂⁻). Sodium primarily forms sodium peroxide (Na₂O₂) when burned in excess oxygen, containing the peroxide ion O₂²⁻. It can also form sodium oxide (Na₂O) containing O²⁻, and sodium superoxide (NaO₂) containing O₂⁻ under specific conditions. The O⁻ ion is not typically found in stable sodium oxides. According to the provided answer key, the correct option is O⁻. However, this is not a common or stable ion in bulk sodium oxides.",
        page: 108,
        section: null // Types of alkali metal oxides
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 16,
        question: "The compound of an alkali metal whose formula is XO₂ is .........",
        options: [
            "a) a normal oxide and the metal oxidation number is -1/2",
            "b) a peroxide and the metal oxidation number is +1",
            "c) a superoxide and the metal oxidation number is +1",
            "d) a superoxide and the oxygen oxidation number is +1/2"
        ],
        correctAnswer: 2,
        correctAnswerText: "c) a superoxide and the metal oxidation number is +1",
        explanation: "In the compound XO₂, X is an alkali metal, which typically has an oxidation state of +1. For the compound to be neutral, the total charge of the O₂ unit must be -1. This corresponds to the superoxide ion, O₂⁻. Thus, XO₂ is a superoxide. In the superoxide ion O₂⁻, the oxidation state of each oxygen atom is -1/2, not +1/2.",
        page: 108,
        section: null // Types of alkali metal oxides
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 17,
        question: "All the following chemical formulas represent peroxides, except .........",
        options: [
            "a) Na₂O₂",
            "b) H₂O₂",
            "c) KO₂",
            "d) BaO₂"
        ],
        correctAnswer: 2,
        correctAnswerText: "c) KO₂",
        explanation: "Peroxides contain the O₂²⁻ ion, where the oxidation state of oxygen is -1. Superoxides contain the O₂⁻ ion, where the oxidation state of oxygen is -1/2. Normal oxides contain the O²⁻ ion, where the oxidation state of oxygen is -2. a) Na₂O₂ contains Na⁺ (+1) and O₂²⁻ (-2 total, -1 per O), a peroxide. b) H₂O₂ contains H⁺ (+1) and O₂²⁻ (-2 total, -1 per O), hydrogen peroxide. c) KO₂ contains K⁺ (+1) and O₂⁻ (-1 total, -1/2 per O), a superoxide. d) BaO₂ contains Ba²⁺ (+2) and O₂²⁻ (-2 total, -1 per O), a peroxide. Therefore, KO₂ is the exception as it is a superoxide.",
        page: 109,
        section: null // Types of oxides
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 18,
        question: "RbO₂ is .........",
        options: [
            "a) a normal oxide.",
            "b) a peroxide.",
            "c) a superoxide.",
            "d) an acidic oxide."
        ],
        correctAnswer: 2,
        correctAnswerText: "c) a superoxide.",
        explanation: "Rb is an alkali metal (Group 1), typically having a +1 oxidation state in compounds. In RbO₂, the formula is XO₂ type. For the compound to be neutral, the O₂ unit must have a charge of -1 (since Rb is +1). O₂⁻ is the superoxide ion. Thus, RbO₂ is a superoxide. Oxides of metals are generally basic, not acidic.",
        page: 109,
        section: null // Types of oxides
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 19,
        question: "Metal (M) has the largest atomic size in its period, its electrons are distributed in 6 energy sublevels. What is the chemical formula of (M) oxide which is formed when (M) is burnt in pure oxygen ?",
        options: [
            "a) MO₂",
            "b) M₂O₂",
            "c) M₂O",
            "d) MO"
        ],
        correctAnswer: 0,
        correctAnswerText: "a) MO₂",
        explanation: "A metal with the largest atomic size in its period is in Group 1 (an alkali metal). Electrons distributed in 6 energy sublevels (1s, 2s, 2p, 3s, 3p, 3d) would mean the highest filled principal shell is n=3 or n=4, including the 3d sublevel. An element whose electrons occupy up to the 3d sublevel would be in the 4th period (e.g., transition metals, Ga, Ge, As, Se, Br, Kr). However, if 'distributed in 6 energy sublevels' refers to the types of sublevels occupied (1s, 2s, 2p, 3s, 3p, 4s), this corresponds to elements in Period 4 like Potassium (K) and Calcium (Ca). Among elements in Period 4, Potassium (K) has the largest atomic size. Potassium is an alkali metal. When alkali metals are burnt in pure (excess) oxygen, lithium forms normal oxide (Li₂O), sodium forms peroxide (Na₂O₂), and potassium, rubidium, and cesium form superoxides (KO₂, RbO₂, CsO₂). Since M is K, and it's burnt in pure oxygen, the product is KO₂, which has the formula MO₂.",
        page: 109,
        section: null // Identification of element and reaction with oxygen
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 20,
        question: "Three alkali metals (X), (Y) and (Z) react with oxygen as follows : X --O₂/Δ--> X₂O ; Y --O₂/Δ--> Y₂O₂ ; Z --O₂/Δ--> ZO₂. Which of the following is correct ?",
        options: [
            "a) According to the chemical activity : Z < Y < X",
            "b) Z can be rubidium.",
            "c) Y₂O₂ is a strong reducing agent.",
            "d) According to the oxidation number : Z < Y < X."
        ],
        correctAnswer: 1,
        correctAnswerText: "b) Z can be rubidium.",
        explanation: "X forms normal oxide (X₂O), typical of Lithium (Li). Y forms peroxide (Y₂O₂), typical of Sodium (Na). Z forms superoxide (ZO₂), typical of Potassium (K), Rubidium (Rb), and Cesium (Cs). The order of alkali metals in the group is Li, Na, K, Rb, Cs. Chemical activity increases down the group (X < Y < Z). Therefore, Z is further down the group than Y and X, meaning Z can be Rubidium or Cesium. Option b) Z can be rubidium is correct. Option a) is incorrect as activity is X < Y < Z. Option c) Peroxides and superoxides are strong oxidizing agents. Option d) The oxidation numbers of oxygen are -2 in X₂O, -1 in Y₂O₂, and -1/2 in ZO₂. The order of oxygen oxidation numbers is ZO₂ (-1/2) > Y₂O₂ (-1) > X₂O (-2), which doesn't match Z < Y < X for the metals.",
        page: 109,
        section: null // Types of alkali metal oxides and reactivity trend
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 21,
        question: "What is the chemical formula of the ideal oxide of alkali element (M) ?",
        options: [
            "a) M₂O₂",
            "b) MO",
            "c) M₂O",
            "d) M₂O₃"
        ],
        correctAnswer: 2,
        correctAnswerText: "c) M₂O",
        explanation: "The ideal or normal oxide of an alkali metal (M, oxidation state +1) contains the oxide ion (O²⁻, oxidation state -2). To balance the charges in a neutral compound, two M⁺ ions are needed for each O²⁻ ion. Therefore, the chemical formula of the normal oxide of an alkali metal is M₂O.",
        page: 109,
        section: null // Types of oxides
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 22,
        question: "What is the correct classification of cesium oxide ?",
        options: [
            "a) Very strong base.",
            "b) Weak base.",
            "c) Acidic oxide.",
            "d) Amphoteric oxide."
        ],
        correctAnswer: 0,
        correctAnswerText: "a) Very strong base.",
        explanation: "Cesium is an alkali metal. Oxides of alkali metals are strongly basic. Basic strength increases down the group. Cesium (Cs) is at the bottom of Group 1, making its oxide (and hydroxide, CsOH) the most basic among the alkali metals. Therefore, cesium oxide is a very strong base.",
        page: 109,
        section: null // Basic character of alkali metal oxides/hydroxides
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 23,
        question: "Upon using 60 mol of KO₂ to purify the air in a submarine, X mol of CO₂ gas are consumed, and Y mol of O₂ gas are produced. What are the numbers of the moles (X) and (Y) ?",
        options: [
            "a) 20 mol of CO₂ / 30 mol of O₂",
            "b) 30 mol of CO₂ / 40 mol of O₂",
            "c) 30 mol of CO₂ / 45 mol of O₂",
            "d) 40 mol of CO₂ / 50 mol of O₂"
        ],
        correctAnswer: 0,
        correctAnswerText: "a) 20 mol of CO₂ / 30 mol of O₂",
        explanation: "The reaction between potassium superoxide (KO₂) and carbon dioxide (CO₂) is used for air purification: 4KO₂(s) + 2CO₂(g) → 2K₂CO₃(s) + 3O₂(g). According to the stoichiometry, 4 moles of KO₂ react with 2 moles of CO₂ to produce 3 moles of O₂. If 60 mol of KO₂ are used, the moles of CO₂ consumed (X) = (60 mol KO₂) * (2 mol CO₂ / 4 mol KO₂) = 30 mol CO₂. The moles of O₂ produced (Y) = (60 mol KO₂) * (3 mol O₂ / 4 mol KO₂) = 45 mol O₂. Based on standard stoichiometry, option c) 30 mol CO₂ / 45 mol O₂ is correct. However, the provided answer key indicates option a) 20 mol of CO₂ / 30 mol of O₂ is correct. This suggests an error in the provided key or question values, as the ratio 4:2:3 from the balanced equation is not reflected in option a.",
        page: 109,
        section: null // Reaction of KO2 with CO2
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 24,
        question: "Which of the following sodium halides has the highest melting point ?",
        options: [
            "a) NaF",
            "b) NaCl",
            "c) NaBr",
            "d) NaI"
        ],
        correctAnswer: 0,
        correctAnswerText: "a) NaF",
        explanation: "Sodium halides (NaX) are ionic compounds. The melting point of ionic compounds depends on the strength of the electrostatic attraction between the ions in the crystal lattice (lattice energy). Lattice energy is directly proportional to the product of ionic charges and inversely proportional to the distance between ion centers. In sodium halides, Na⁺ has a constant charge (+1). The halides are F⁻, Cl⁻, Br⁻, I⁻, all with a -1 charge. The distance between ions is the sum of the ionic radii of Na⁺ and the halide ion. Ionic radii increase down the group: F⁻ < Cl⁻ < Br⁻ < I⁻. Thus, the distance between Na⁺ and X⁻ increases from NaF to NaI. As the distance increases, the lattice energy decreases, and the melting point decreases. NaF has the smallest halide ion (F⁻), resulting in the shortest distance, highest lattice energy, and highest melting point.",
        page: 109,
        section: null // Properties of ionic compounds (melting point)
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 25,
        question: "Which of the following pairs of elements react together more vigorously ?",
        options: [
            "a) Cs and Cl",
            "b) Cs and F",
            "c) Na and Cl",
            "d) Na and F"
        ],
        correctAnswer: 1,
        correctAnswerText: "b) Cs and F",
        explanation: "Reactions between metals and non-metals are redox reactions. Reactivity of alkali metals (reducing agents) increases down the group (Li < Na < K < Rb < Cs). Reactivity of halogens (oxidizing agents) decreases down the group (F > Cl > Br > I). The most vigorous reaction occurs between the most reactive metal and the most reactive non-metal. Among the options, Cesium (Cs) is the most reactive alkali metal, and Fluorine (F) is the most reactive halogen. Therefore, the reaction between Cs and F will be the most vigorous.",
        page: 109,
        section: null // Reactivity trends
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 26,
        question: "All alkali carbonates melt by strong heating without decomposition, except .........",
        options: [
            "a) lithium carbonate.",
            "b) sodium carbonate.",
            "c) potassium carbonate.",
            "d) cesium carbonate."
        ],
        correctAnswer: 0,
        correctAnswerText: "a) lithium carbonate.",
        explanation: "Alkali metal carbonates are generally stable to heat and melt without decomposing, except for lithium carbonate (Li₂CO₃). Due to the small size and high charge density of the Li⁺ ion, it strongly polarizes the carbonate ion, leading to its decomposition upon heating: Li₂CO₃(s) → Li₂O(s) + CO₂(g). Other alkali metal carbonates (Na₂CO₃, K₂CO₃, Rb₂CO₃, Cs₂CO₃) are stable to heat and melt without decomposition.",
        page: 110,
        section: null // Thermal stability of carbonates
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 27,
        question: "All the following reactions occur vigorously, except .........",
        options: [
            "a) the decomposition reaction of potassium nitrate.",
            "b) the reaction of sodium with chlorine.",
            "c) the reaction of potassium with water.",
            "d) the reaction of lithium with nitrogen."
        ],
        correctAnswer: 3,
        correctAnswerText: "d) the reaction of lithium with nitrogen.",
        explanation: "Reactions of alkali metals with halogens (like Na with Cl₂) and water (like K with H₂O) are highly exothermic and vigorous. The decomposition of potassium nitrate upon heating can also be vigorous, releasing oxygen. However, the reaction of lithium with nitrogen (forming Li₃N) requires heating to occur and is not typically as vigorous as the reactions of alkali metals with water or halogens. It's a unique reaction for lithium among alkali metals.",
        page: 110,
        section: null // Vigor of reactions
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 28,
        question: "Each of the following represents the alkali metal (X) whose electrons are distributed in two energy levels, except that .........",
        options: [
            "a) its carbonate salt decomposes by heat.",
            "b) it has the least ionization potential in its period.",
            "c) it reacts with water forming an alkaline solution.",
            "d) it has the largest radius among its group elements."
        ],
        correctAnswer: 3,
        correctAnswerText: "d) it has the largest radius among its group elements.",
        explanation: "An alkali metal with electrons distributed in two energy levels means its valence electrons are in the second energy shell (n=2). This describes Lithium (Li), with electron configuration 1s² 2s¹. Let's evaluate the statements for Lithium: a) Li₂CO₃ decomposes by heat (correct, see Q26, Q29). b) Li is in Period 2; it has the lowest ionization potential in Period 2 (correct). c) Li reacts with water to form LiOH solution (alkaline) and H₂ (correct). d) Atomic radius increases down Group 1; Li is at the top and has the *smallest* radius among alkali metals, not the largest (incorrect). Therefore, statement d is the exception.",
        page: 110,
        section: null // Properties of Lithium
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 29,
        question: "All the following alkali metals carbonates are thermally stable, except .........",
        options: [
            "a) Li₂CO₃",
            "b) Na₂CO₃",
            "c) K₂CO₃",
            "d) Cs₂CO₃"
        ],
        correctAnswer: 0,
        correctAnswerText: "a) Li₂CO₃",
        explanation: "This is the same question as 26. Lithium carbonate (Li₂CO₃) decomposes upon heating, while the carbonates of other alkali metals (Na₂CO₃, K₂CO₃, Rb₂CO₃, Cs₂CO₃) are thermally stable and melt without decomposition.",
        page: 110,
        section: null // Thermal stability of carbonates
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 30,
        question: "Heating sodium nitrate produces .........",
        options: [
            "a) NO gas.",
            "b) NO₂ gas.",
            "c) N₂O gas.",
            "d) O₂ gas."
        ],
        correctAnswer: 3,
        correctAnswerText: "d) O₂ gas.",
        explanation: "Alkali metal nitrates decompose upon heating. Lithium nitrate (LiNO₃) decomposes like Group 2 nitrates (to oxide, NO₂, and O₂). However, nitrates of sodium and other heavier alkali metals decompose to the metal nitrite and oxygen gas: 2NaNO₃(s) → 2NaNO₂(s) + O₂(g). Therefore, heating sodium nitrate produces oxygen gas (along with sodium nitrite).",
        page: 110,
        section: null // Thermal decomposition of nitrates
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 31,
        question: "Sodium carbonate is similar to lithium carbonate in...",
        options: [
            "a) the effect of the strong heat on both of them.",
            "b) the gas produced from their reactions with the acids.",
            "c) their melting points.",
            "d) the colour formed during the dry test."
        ],
        correctAnswer: 1,
        correctAnswerText: "b) the gas produced from their reactions with the acids.",
        explanation: "a) Incorrect; Li₂CO₃ decomposes upon heating, while Na₂CO₃ melts without decomposition (see Q26, Q29). b) Correct; Both lithium carbonate and sodium carbonate react with acids to produce carbon dioxide gas: M₂CO₃(s) + 2HA(aq) → 2MA(aq) + H₂O(l) + CO₂(g). c) Incorrect; Melting points of alkali carbonates are different (e.g., Li₂CO₃ melts at 723°C, Na₂CO₃ melts at 851°C). d) Incorrect; The dry test (flame test) identifies the cation: Li⁺ gives a red flame, Na⁺ gives a yellow flame.",
        page: 110,
        section: null // Comparison of Li and Na carbonates
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 32,
        question: "Sodium metal is extracted in industry by the electrolysis of...",
        options: [
            "a) sodium chloride solution.",
            "b) molten sodium chloride.",
            "c) caustic soda solution.",
            "d) molten caustic potash."
        ],
        correctAnswer: 1,
        correctAnswerText: "b) molten sodium chloride.",
        explanation: "Active metals like sodium are extracted industrially by the electrolysis of their molten salts. The primary industrial method for sodium extraction is the Downs process, which involves the electrolysis of molten sodium chloride (NaCl). Electrolysis of aqueous solutions is not used because water is more easily reduced than Na⁺ ions. Electrolysis of molten NaOH is also possible but less common industrially for pure sodium.",
        page: 110,
        section: "Extraction of alkali metals from their ores"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 33,
        question: "What are the oxidizing agent and the reducing agent in the electrolysis of sodium chloride melt respectively?",
        options: [
            "a) Cl / Na",
            "b) Cl⁻ / Na⁺",
            "c) Na⁺ / Cl⁻",
            "d) Na / Cl"
        ],
        correctAnswer: 2,
        correctAnswerText: "c) Na⁺ / Cl⁻",
        explanation: "In the electrolysis of molten sodium chloride, sodium ions (Na⁺) are reduced at the cathode (gain electrons: Na⁺ + e⁻ → Na). The species that gains electrons is the oxidizing agent. Chloride ions (Cl⁻) are oxidized at the anode (lose electrons: 2Cl⁻ → Cl₂ + 2e⁻). The species that loses electrons is the reducing agent. Therefore, the oxidizing agent is Na⁺ and the reducing agent is Cl⁻.",
        page: 110,
        section: "Extraction of alkali metals from their ores"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 34,
        question: "What happens when a sample of solid sodium hydroxide flakes is left in air for hours ?",
        options: [
            "a) It does not change.",
            "b) It becomes harder.",
            "c) Its mass increases.",
            "d) Its mass decreases."
        ],
        correctAnswer: 2,
        correctAnswerText: "c) Its mass increases.",
        explanation: "Solid sodium hydroxide (NaOH) is hygroscopic and deliquescent, meaning it absorbs moisture from the air. It also reacts with carbon dioxide from the air: 2NaOH(s) + CO₂(g) → Na₂CO₃(s) + H₂O(l). Both the absorbed water and the incorporated carbon dioxide lead to an increase in the mass of the sample over time. The flakes would absorb water and potentially dissolve, so 'becomes harder' is not generally accurate.",
        page: 111,
        section: "Sodium hydroxide"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 35,
        question: "Excess of sodium hydroxide solution is added to a beaker containing aluminum sulphate. Which of the following exist in the beaker after the end of the reaction ?",
        options: [
            "a) H₂O, AlO₂⁻, Na⁺",
            "b) Al(OH)₃, SO₄²⁻, Na⁺",
            "c) H₂O, Al³⁺, SO₄²⁻, OH⁻, Na⁺",
            "d) H₂O, AlO₂⁻, SO₄²⁻, OH⁻, Na⁺"
        ],
        correctAnswer: 3,
        correctAnswerText: "d) H₂O, AlO₂⁻, SO₄²⁻, OH⁻, Na⁺",
        explanation: "When sodium hydroxide solution is added to aluminum sulfate solution, aluminum ions (Al³⁺) react with hydroxide ions (OH⁻) to form aluminum hydroxide precipitate (Al(OH)₃): Al³⁺(aq) + 3OH⁻(aq) → Al(OH)₃(s). If excess sodium hydroxide is added, the amphoteric aluminum hydroxide dissolves by reacting with the excess OH⁻ ions to form soluble aluminate ions (AlO₂⁻ or [Al(OH)₄]⁻): Al(OH)₃(s) + OH⁻(aq) → AlO₂⁻(aq) + 2H₂O(l). The spectator ions Na⁺ (from NaOH) and SO₄²⁻ (from Al₂(SO₄)₃) remain in solution. Since excess NaOH was added, OH⁻ ions are also present. Water is the solvent. Therefore, the species present in the beaker are H₂O (solvent), Na⁺, SO₄²⁻, AlO₂⁻, and excess OH⁻.",
        page: 111,
        section: "Sodium hydroxide"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 36,
        question: "Hydrated sodium carbonate salt is known as .........",
        options: [
            "a) quicklime.",
            "b) washing soda.",
            "c) caustic soda.",
            "d) limewater."
        ],
        correctAnswer: 1,
        correctAnswerText: "b) washing soda.",
        explanation: "Hydrated sodium carbonate (Na₂CO₃·10H₂O) is commonly known as washing soda. Quicklime is calcium oxide (CaO). Caustic soda is sodium hydroxide (NaOH). Limewater is a saturated solution of calcium hydroxide (Ca(OH)₂).",
        page: 111,
        section: "Sodium carbonate"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 37,
        question: "On dissolving an amount of the flakes of the substance (X) in water and heating this solution, then passing the gas (Y) in it, and then allowing it to cool, the crystals of (Z) are separated. What do the letters (X), (Y) and (Z) represent respectively ?",
        options: [
            "a) NaOH / CO₂ / Washing soda.",
            "b) NaOH / NH₃ / Washing soda.",
            "c) Na₂CO₃ / CO₂ / Sodium carbonate.",
            "d) Na₂CO₃ / NH₃ / Sodium carbonate."
        ],
        correctAnswer: 0,
        correctAnswerText: "a) NaOH / CO₂ / Washing soda.",
        explanation: "Dissolving sodium hydroxide flakes (X = NaOH) in water forms a solution. Passing carbon dioxide gas (Y = CO₂) through a hot sodium hydroxide solution produces sodium carbonate: 2NaOH(aq) + CO₂(g) → Na₂CO₃(aq) + H₂O(l). Cooling a concentrated solution of sodium carbonate leads to the crystallization of hydrated sodium carbonate, or washing soda (Z = Washing soda, Na₂CO₃·10H₂O). This sequence matches option a.",
        page: 111,
        section: "Sodium carbonate"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 38,
        question: "Which of the following represents the mass of the crystallization water compared to the mass of the anhydrous salt in 1 mol of washing soda ? [Na₂CO₃ = 106 g/mol, H₂O = 18 g/mol]",
        options: [
            "a) The mass of crystallization water is less than half that of the anhydrous salt.",
            "b) The mass of crystallization water is less than double that of the anhydrous salt.",
            "c) The mass of crystallization water is double that of the anhydrous salt.",
            "d) The mass of crystallization water is half that of the anhydrous salt."
        ],
        correctAnswer: 1,
        correctAnswerText: "b) The mass of crystallization water is less than double that of the anhydrous salt.",
        explanation: "Washing soda is Na₂CO₃·10H₂O. The molar mass of anhydrous Na₂CO₃ is 106 g/mol. The molar mass of H₂O is 18 g/mol. In 1 mole of washing soda, there is 1 mole of anhydrous Na₂CO₃ (106 g) and 10 moles of H₂O (10 * 18 g = 180 g). Comparing the mass of water (180 g) to the mass of anhydrous salt (106 g): a) 180 < 0.5 * 106 (53)? False. b) 180 < 2 * 106 (212)? True. c) 180 = 2 * 106 (212)? False. d) 180 = 0.5 * 106 (53)? False. Therefore, the mass of crystallization water (180 g) is less than double the mass of the anhydrous salt (212 g).",
        page: 111,
        section: "Sodium carbonate"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 39,
        question: "Which of the following two substances dissolve in water (each separately) forming aqueous solutions ?",
        options: [
            "a) Al(OH)₃, NaOH",
            "b) NaAlO₂, AlCl₃",
            "c) Cu(OH)₂, NaCl",
            "d) CaCO₃, Na₂CO₃"
        ],
        correctAnswer: 3,
        correctAnswerText: "d) CaCO₃, Na₂CO₃",
        explanation: "Based on general solubility rules: a) Al(OH)₃ is insoluble, NaOH is soluble. b) NaAlO₂ (sodium aluminate) is generally soluble, AlCl₃ (aluminum chloride) is soluble. Both dissolve. c) Cu(OH)₂ is insoluble, NaCl is soluble. d) CaCO₃ (calcium carbonate) is generally insoluble, Na₂CO₃ (sodium carbonate) is soluble. According to standard solubility rules, option b) contains two soluble compounds. However, the provided answer key indicates option d) is correct. Based on the standard rules, only Na₂CO₃ in option d) is soluble, while CaCO₃ is insoluble. There appears to be an error in the provided answer key.",
        page: 111,
        section: null // Solubility
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 40,
        question: "In Solvay process, gas (W) is dissolved in a saturated solution of substance (X), and then the gas (Y) is passed in the former mixture with heating, substance (Z) can be obtained. Which of the following identifies correctly any of (W), (X), (Y) and (Z) ?",
        options: [
            "a) (W) : CO₂, (Z) : NaHCO₃",
            "b) (X): NH₄Cl, (Y) : NH₃",
            "c) (X) : NaCl, (Y) : H₂",
            "d) (W) : NH₃, (Z) : Na₂CO₃"
        ],
        correctAnswer: 3,
        correctAnswerText: "d) (W) : NH₃, (Z) : Na₂CO₃",
        explanation: "The Solvay process produces sodium carbonate (Z = Na₂CO₃) using ammonia (W = NH₃), carbon dioxide (Y = CO₂), and a saturated solution of sodium chloride (X = NaCl solution, or brine). The process involves dissolving ammonia in brine, then passing carbon dioxide through the ammoniated brine to precipitate sodium bicarbonate (intermediate product), which is then heated to form sodium carbonate. Option d) correctly identifies the input gas (W) as NH₃ and the final product (Z) as Na₂CO₃, which are key components of the Solvay process.",
        page: 112,
        section: "Solvay process"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 41,
        question: "What is the similarity between sodium hydroxide and sodium carbonate ?",
        options: [
            "a) They both have the same molar mass.",
            "b) They both can react with acids yielding CO₂ gas.",
            "c) They both can react with bases.",
            "d) They both are used in paper industry."
        ],
        correctAnswer: 3,
        correctAnswerText: "d) They both are used in paper industry.",
        explanation: "a) Incorrect: Molar mass of NaOH is ~40 g/mol, Molar mass of Na₂CO₃ is ~106 g/mol. b) Incorrect: Na₂CO₃ reacts with acids yielding CO₂, but NaOH reacts with acids in a neutralization reaction without producing CO₂. c) Incorrect: Both NaOH and Na₂CO₃ solutions are basic and do not react with bases. d) Correct: Both sodium hydroxide (caustic soda) and sodium carbonate (soda ash) are widely used in the paper industry, for example, in pulping processes and paper manufacturing.",
        page: 112,
        section: null // Uses of NaOH and Na2CO3
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 42,
        question: "In the following unbalanced equations : Na₂CO₃(s) + X → Y + H₂O(l) + CO₂(g) ; NaOH(aq) + X → Y + H₂O(l). What are the types of the substances (X) and (Y) ?",
        options: [
            "a) (X) : Salt / (Y) : Acid.",
            "b) (X) : Acid / (Y) : Salt.",
            "c) (X) : Base / (Y) : Salt.",
            "d) (X) : Acid / (Y) : Base."
        ],
        correctAnswer: 1,
        correctAnswerText: "b) (X) : Acid / (Y) : Salt.",
        explanation: "In the first equation, Na₂CO₃ (a carbonate salt) reacts with X to produce CO₂ gas, water, and substance Y. The production of CO₂ from a carbonate is characteristic of a reaction with an acid. So, X is an acid. The products are salt (Y), water, and carbon dioxide (salt + acid → salt + water + CO₂). In the second equation, NaOH (a base) reacts with X (the same substance) to produce Y and water. This is a neutralization reaction between a base and an acid (base + acid → salt + water). Thus, X is an acid, and Y is a salt. For example, if X = HCl, then Na₂CO₃ + 2HCl → 2NaCl + H₂O + CO₂, so Y = NaCl (a salt). And NaOH + HCl → NaCl + H₂O, so Y = NaCl (a salt).",
        page: 112,
        section: null // Reactions of carbonates and hydroxides
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 43,
        question: "All the following statements are correct, except that .........",
        options: [
            "a) potassium reacts vigorously with water.",
            "b) cesium hydroxide is a strong base.",
            "c) sodium hydroxide dissolution in water is exothermic.",
            "d) lithium chloride dissolves in alcohol but not in water."
        ],
        correctAnswer: 3,
        correctAnswerText: "d) lithium chloride dissolves in alcohol but not in water.",
        explanation: "a) Correct; Alkali metals react vigorously with water, and reactivity increases down the group, so Potassium reacts vigorously. b) Correct; Alkali metal hydroxides are strong bases, and basic strength increases down the group, so CsOH is a strong base. c) Correct; Dissolving solid NaOH in water releases heat (exothermic). d) Incorrect; Lithium chloride (LiCl) is an ionic salt and is soluble in water. While it also has some solubility in polar organic solvents like alcohol due to partial covalent character, stating it does not dissolve in water is false.",
        page: 112,
        section: null // Properties and reactions of alkali metals/compounds
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 44,
        question: "The common ions present in the living cell are .........",
        options: [
            "a) Ca²⁺ ions.",
            "b) K⁺ ions.",
            "c) Li⁺ ions.",
            "d) Mg²⁺ ions."
        ],
        correctAnswer: 1,
        correctAnswerText: "b) K⁺ ions.",
        explanation: "Potassium ions (K⁺) are the principal cations found inside animal cells, playing a vital role in maintaining cell volume, nerve impulse transmission, and enzyme activity. Sodium ions (Na⁺) are the principal cations outside animal cells, also critical for nerve function (Na⁺/K⁺ pump). Calcium ions (Ca²⁺) and magnesium ions (Mg²⁺) are also important ions in living cells, involved in signaling, muscle contraction, and as enzyme cofactors, but K⁺ is typically the most abundant cation within the intracellular fluid. Lithium ions (Li⁺) are not considered common or essential ions in normal biological function.",
        page: 112,
        section: "The biochemical role of some ions"
    },
    {
        topic: Topics.ALKALI_METALS,
        originalNumber: 45,
        question: "The living cell transfers (X) through (Y). Which of the following represents (X) and (Y) respectively ?",
        options: [
            "a) K⁺ / Glucose.",
            "b) Proteins / Na⁺.",
            "c) K⁺ / Proteins.",
            "d) Glucose / Na⁺."
        ],
        correctAnswer: 3,
        correctAnswerText: "d) Glucose / Na⁺.",
        explanation: "Many transport processes across cell membranes involve the movement of a substance (X) coupled to the movement of an ion (Y), often utilizing the electrochemical gradient of the ion. A well-known example is the sodium-glucose co-transport system, where glucose (X) is transported across the cell membrane against its concentration gradient, powered by the movement of sodium ions (Y) down their electrochemical gradient. This system 'transfers' glucose 'through' or 'via' the coupling with sodium ion transport. Proteins are usually the transporter molecules themselves, not the substance being transported 'through' ions.",
        page: 112,
        section: "The biochemical role of some ions"
    }
];

        const quotes = [
            "The only way to do great work is to love what you do. – Steve Jobs",
            "Education is the most powerful weapon which you can use to change the world. – Nelson Mandela",
            "The future belongs to those who believe in the beauty of their dreams. – Eleanor Roosevelt",
            "Strive for progress, not perfection.",
            "The expert in anything was once a beginner.",
            "Don't watch the clock; do what it does. Keep going.",
            "Success is not final, failure is not fatal: It is the courage to continue that counts. – Winston Churchill",
            "The mind is not a vessel to be filled, but a fire to be kindled. – Plutarch",
            "Study hard what interests you the most in the most undisciplined, irreverent and original manner possible. – Richard Feynman",
            "Learning never exhausts the mind. – Leonardo da Vinci"
        ];


        let currentQuestionIndex = 0;
        let score = 0;
        let buttonsDisabled = false; // Controls user input on answer/skip buttons
        let gameInProgress = false; // Controls overall game state
        let currentTopicQuestions = [];
        let lessonAttempts = []; // To store results for PDF (mistakes and skips)
        let questionsToRemember = []; // To store questions added to remember list

        // Get DOM elements
        const lessonSelectionElement = document.getElementById('lesson-selection');
        const gameContainerElement = document.querySelector('.game-container');
        const gameTitleElement = document.getElementById('game-title');
        const questionCounterElement = document.querySelector('.question-counter');
        const currentQNumElement = document.getElementById('current-q-num');
        const totalQNumElement = document.getElementById('total-q-num');
        const questionAreaElement = document.getElementById('question-area');
        const questionTextElement = document.getElementById('question-text');
        const answerButtonsElement = document.getElementById('answer-buttons');
        const feedbackElement = document.getElementById('feedback');
        const explanationAreaElement = document.getElementById('explanation-area');
        const explanationTextElement = document.getElementById('explanation-text');
        const scoreAreaElement = document.getElementById('score-area');
        const scoreElement = document.getElementById('score');
        const skipButton = document.getElementById('skip-button');
        const nextButton = document.getElementById('next-button');
        const addToRememberButton = document.getElementById('add-to-remember-button'); // Get remember button
        const finalScoreElement = document.getElementById('final-score');
        const finalScoreTextElement = document.getElementById('final-score-text');
        const finalTotalTextElement = document.getElementById('final-total-text');
        const restartButton = document.getElementById('restart-button');
        const downloadPdfButton = document.getElementById('download-mistakes-pdf');
        const exportAllPdfButton = document.getElementById('export-all-pdf-button'); // Get export all button
        const quoteAreaElement = document.getElementById('quote-area');
        const currentQuoteElement = document.getElementById('current-quote');


        // --- Functions ---

        function showLessonSelection() {
            gameInProgress = false;
            // Hide game elements
            gameContainerElement.classList.add('hidden');
            finalScoreElement.classList.add('hidden');
            explanationAreaElement.classList.add('hidden');
            explanationAreaElement.classList.remove('visible'); // Remove animation class
            addToRememberButton.classList.add('hidden'); // Hide remember button
            quoteAreaElement.classList.add('hidden'); // Hide quote area

            // Show lesson selection
            lessonSelectionElement.classList.remove('hidden');

            // Clear existing buttons before adding new ones
            // Clone the element before removing children to avoid issues if the element itself is removed/re-added elsewhere
             const lessonSelectionClone = lessonSelectionElement.cloneNode(true);
             while (lessonSelectionElement.firstChild) {
                 lessonSelectionElement.removeChild(lessonSelectionElement.firstChild);
             }
             // Add back the h2 title
             const title = document.createElement('h2');
             title.textContent = 'Choose a Lesson';
             lessonSelectionElement.appendChild(title);


            for (const topicKey in Topics) {
                const topicName = Topics[topicKey];
                // Check if there are questions for this topic before adding the button
                const questionsForTopic = allQuestions.filter(q => q.topic === topicName);
                if (questionsForTopic.length > 0) {
                    const btn = document.createElement("button");
                    btn.classList.add("action-button");
                    btn.innerText = `${topicName} (${questionsForTopic.length} Questions)`;
                    btn.addEventListener('click', () => startGame(topicName));
                    lessonSelectionElement.appendChild(btn);
                }
            }
        }

        function startGame(topic) {
            gameInProgress = true;
            console.log(`Starting lesson: ${topic}`);
            // Filter questions based on the chosen topic and sort by original number
            currentTopicQuestions = allQuestions
                .filter(q => q.topic === topic)
                .sort((a, b) => a.originalNumber - b.originalNumber); // Sort by original number

            if (currentTopicQuestions.length === 0) {
                alert(`No questions found for the topic: ${topic}`);
                showLessonSelection(); // Go back to selection if no questions
                return;
            }


            // Reset game state
            currentQuestionIndex = 0;
            score = 0;
            lessonAttempts = []; // Clear attempts for the new lesson
            questionsToRemember = []; // Clear remember list for the new lesson
            scoreElement.textContent = score;
            totalQNumElement.textContent = currentTopicQuestions.length; // Update total count

            // Update game title
            gameTitleElement.textContent = `Game Show! - ${topic}`; // Updated title

            // Hide lesson selection
            lessonSelectionElement.classList.add('hidden');

            // Show game elements
            gameContainerElement.classList.remove('hidden');
            questionAreaElement.classList.remove('hidden');
            feedbackElement.classList.remove('hidden');
            scoreAreaElement.classList.remove('hidden');
            quoteAreaElement.classList.remove('hidden');
            questionCounterElement.classList.remove('hidden'); // Show question counter

            // Hide end game elements
            finalScoreElement.classList.add('hidden');
            nextButton.classList.add('hidden');
            restartButton.classList.add('hidden');
            downloadPdfButton.classList.add('hidden');
            exportAllPdfButton.classList.add('hidden'); // Hide export all button

            displayQuestion();
            displayRandomQuote();
        }

        function displayQuestion() {
            resetState(); // Clears feedback, explanation, buttons, etc.
            buttonsDisabled = false; // Re-enable input

            skipButton.classList.remove('hidden'); // Show the skip button
            skipButton.disabled = false; // Enable the skip button
            addToRememberButton.classList.add('hidden'); // Hide remember button for new question
            // checkRememberButtonState will make it visible if the question is correct

            const question = currentTopicQuestions[currentQuestionIndex];

            if (!question) {
                console.error("Question index out of bounds or no questions found.");
                questionTextElement.innerHTML = "Error: Could not load next question."; // Use innerHTML for potential HTML
                buttonsDisabled = true;
                nextButton.classList.add('hidden');
                skipButton.classList.add('hidden'); // Hide skip button on error
                addToRememberButton.classList.add('hidden'); // Hide remember button on error
                 quoteAreaElement.classList.add('hidden'); // Hide quote area on error
                setTimeout(() => restartButton.classList.remove('hidden'), 2000);
                return;
            }

            // Update question counter
            currentQNumElement.textContent = currentQuestionIndex + 1;

            questionTextElement.innerHTML = question.question; // Use innerHTML

            if (!question.options || question.options.length === 0) {
                console.error("Question has no options:", question);
                 questionTextElement.innerHTML = `Error loading question ${question.originalNumber}. Please check the question data.`; // Use innerHTML
                buttonsDisabled = true;
                skipButton.classList.add('hidden'); // Hide skip button on error
                addToRememberButton.classList.add('hidden'); // Hide remember button on error
                 quoteAreaElement.classList.add('hidden'); // Hide quote area on error
                if (currentQuestionIndex < currentTopicQuestions.length - 1) {
                    setTimeout(() => { nextButton.classList.remove('hidden'); }, 800);
                } else {
                    setTimeout(endGame, 1000);
                }
                return;
            }

            answerButtonsElement.innerHTML = ''; // Clear previous buttons effectively
            question.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.innerHTML = option; // Use innerHTML
                button.classList.add('answer-button');
                button.dataset.index = index;

                // Use an anonymous function to call selectAnswer with the correct index
                button.addEventListener('click', () => selectAnswer(index));
                answerButtonsElement.appendChild(button);
            });
        }

        function resetState() {
            // Clear previous answer buttons! - Replaced while loop with innerHTML = ''
             answerButtonsElement.innerHTML = '';


            feedbackElement.textContent = '';
            feedbackElement.style.color = '';
            explanationAreaElement.classList.add('hidden');
            explanationAreaElement.classList.remove('visible');
            explanationTextElement.innerHTML = ''; // Use innerHTML
            nextButton.classList.add('hidden');
            // skipButton and addToRememberButton visibility/state are managed in displayQuestion and selectAnswer/skipQuestion
        }

        function selectAnswer(selectedIndex) {
            if (buttonsDisabled) return; // Prevent double-clicking
            buttonsDisabled = true; // Disable input once an answer is chosen

            // Disable and hide the skip button immediately
            skipButton.disabled = true;
            skipButton.classList.add('hidden');

            // Disable all answer buttons
            const answerButtons = answerButtonsElement.querySelectorAll('.answer-button');
            answerButtons.forEach(button => button.disabled = true);

            const question = currentTopicQuestions[currentQuestionIndex];
            const isCorrect = (selectedIndex === question.correctAnswer);

            // Record the attempt
            lessonAttempts.push({
                originalNumber: question.originalNumber, // Include original number
                questionText: question.question, // Keep original HTML
                selectedAnswer: question.options[selectedIndex], // Keep original HTML
                correctAnswerText: question.correctAnswerText, // Keep original HTML
                options: question.options, // Keep original HTML options list
                explanation: question.explanation, // Keep original HTML
                isCorrect: isCorrect,
                topic: question.topic,
                // Do NOT add isRememberedItem: true here
            });

            // Highlight buttons
            answerButtons.forEach((button, index) => {
                if (index === question.correctAnswer) {
                    button.classList.add('correct');
                } else if (index === selectedIndex) {
                    button.classList.add('incorrect');
                }
            });

            if (isCorrect) {
                score++;
                scoreElement.textContent = score;
                feedbackElement.textContent = 'Correct!';
                feedbackElement.style.color = '#28a745'; // Green

                // *** Show and check state of Add to Remember button ONLY if correct ***
                addToRememberButton.classList.remove('hidden');
                checkRememberButtonState(question); // Check if already added and set state/text

            } else {
                feedbackElement.textContent = `Incorrect.`;
                feedbackElement.style.color = '#dc3545'; // Red
                addToRememberButton.classList.add('hidden'); // Ensure hidden if incorrect
            }

            // Display explanation with animation (includes correct answer)
            // Construct explanation HTML to include Correct Answer text for display
            const explanationHtml = `<strong>Correct Answer:</strong> ${question.correctAnswerText}<br><br><strong>Explanation:</strong> ${question.explanation}`;
            explanationTextElement.innerHTML = explanationHtml; // Use innerHTML
            explanationAreaElement.classList.remove('hidden');
            setTimeout(() => {
                explanationAreaElement.classList.add('visible');
            }, 10);


            // Determine next action after a delay
            if (currentQuestionIndex < currentTopicQuestions.length - 1) {
                setTimeout(() => {
                    nextButton.classList.remove('hidden');
                }, 800); // Faster timeout
            } else {
                // This is the last question
                setTimeout(endGame, 1200); // Faster endgame
            }
        }

        function skipQuestion() {
            if (buttonsDisabled) return; // Prevent double-clicking
            buttonsDisabled = true; // Disable input once skip is clicked

            // Disable and hide the skip button immediately
            skipButton.disabled = true;
            skipButton.classList.add('hidden');

            // Disable all answer buttons
            const answerButtons = answerButtonsElement.querySelectorAll('.answer-button');
            answerButtons.forEach(button => button.disabled = true);

            const question = currentTopicQuestions[currentQuestionIndex];

            // Record the attempt as skipped/incorrect - PUSH A STRUCTURED OBJECT
             lessonAttempts.push({
                originalNumber: question.originalNumber,
                questionText: question.question, // Include question text
                selectedAnswer: "[Skipped]", // Indicate it was skipped
                correctAnswerText: question.correctAnswerText, // Include correct answer text
                options: question.options, // Include options
                explanation: question.explanation, // Include explanation
                isCorrect: false, // Mark as incorrect/missed for filtering
                topic: question.topic,
                // Do NOT add isRememberedItem: true here
            });


            // Provide feedback for skipping
            feedbackElement.textContent = 'Question Skipped.';
            feedbackElement.style.color = '#ffc107'; // Yellow/Orange color for skipped feedback

            // Highlight the correct answer button visually (if it exists)
             const answerButtonsList = answerButtonsElement.querySelectorAll('.answer-button');
            if (question.correctAnswer >= 0 && question.correctAnswer < answerButtonsList.length) {
                 answerButtonsList[question.correctAnswer].classList.add('correct');
            }


            // Display explanation and correct answer with animation
             const explanationHtml = `<strong>Correct Answer:</strong> ${question.correctAnswerText}<br><br><strong>Explanation:</strong> ${question.explanation}`;
             explanationTextElement.innerHTML = explanationHtml; // Use innerHTML
            explanationAreaElement.classList.remove('hidden');
            setTimeout(() => {
                explanationAreaElement.classList.add('visible');
            }, 10);

            // *** Do NOT show "Add to Remember" button if skipped ***
            addToRememberButton.classList.add('hidden');


            // Determine next action after a delay
            if (currentQuestionIndex < currentTopicQuestions.length - 1) {
                setTimeout(() => {
                    nextButton.classList.remove('hidden');
                }, 800); // Faster timeout
            } else {
                setTimeout(endGame, 1200);
            }
        }

        // Function to check and set the state of the "Add to Remember" button
        function checkRememberButtonState(question) {
            // Check if the current question is already in the remember list
            const isAlreadyAdded = questionsToRemember.some(q => q.originalNumber === question.originalNumber && q.topic === question.topic);

            if (isAlreadyAdded) {
                addToRememberButton.textContent = "Added!";
                addToRememberButton.disabled = true;
                 // Styling is handled by the CSS :disabled rule now
            } else {
                addToRememberButton.textContent = "Add to Remember List";
                addToRememberButton.disabled = false;
                 // Styling is handled by the CSS rule for #add-to-remember-button
            }
        }


        // Function to add the current question to the remember list when button is clicked
        function addToRememberList() {
            const question = currentTopicQuestions[currentQuestionIndex];
            // Check if the current question is already in the remember list before adding
            const isAlreadyAdded = questionsToRemember.some(q => q.originalNumber === question.originalNumber && q.topic === question.topic);

            if (!isAlreadyAdded) {
                // Add a copy of the question object, ensuring all needed properties are included
                 // We should store the necessary properties explicitly to avoid issues if the original question object structure changes later
                questionsToRemember.push({
                    originalNumber: question.originalNumber,
                    question: question.question, // Use 'question' as it is in the original object
                    options: question.options,
                    correctAnswer: question.correctAnswer, // Store index for consistency
                    correctAnswerText: question.correctAnswerText, // Store text
                    explanation: question.explanation,
                    topic: question.topic,
                    isRememberedItem: true // Add flag to distinguish from attempts
                });
                // Update button state immediately
                checkRememberButtonState(question); // This will set the text to "Added!" and disable the button
                console.log(`Question ${question.originalNumber} added to remember list.`);
            }
            // If it was already added, the button should have been disabled already by checkRememberButtonState
        }


        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < currentTopicQuestions.length) {
                displayQuestion(); // displayQuestion will handle showing/enabling the skip and hiding remember button
                displayRandomQuote();
            } else {
                // Should be handled by selectAnswer/skipQuestion, but included for safety
                endGame();
            }
        }

        function endGame() {
            gameInProgress = false;
            // Hide game elements
            questionAreaElement.classList.add('hidden');
            feedbackElement.classList.add('hidden');
            explanationAreaElement.classList.add('hidden');
            explanationAreaElement.classList.remove('visible');
            scoreAreaElement.classList.add('hidden');
            nextButton.classList.add('hidden');
            skipButton.classList.add('hidden'); // Ensure skip button is hidden at the end
            addToRememberButton.classList.add('hidden'); // Ensure remember button is hidden at the end
            quoteAreaElement.classList.add('hidden');
            questionCounterElement.classList.add('hidden');

            // Show final score and restart button
            finalScoreElement.classList.remove('hidden');
            finalScoreTextElement.textContent = score;
            finalTotalTextElement.textContent = currentTopicQuestions.length;
            restartButton.classList.remove('hidden');

            // Show Review PDF button only if there were mistakes OR skips OR items to remember
             // Filter includes items where isCorrect is false (incorrect/skipped)
            const mistakesOrSkips = lessonAttempts
                .filter(attempt => !attempt.isCorrect)
                .sort((a, b) => a.originalNumber - b.originalNumber); // Sort by original question number

            const rememberItems = questionsToRemember.sort((a, b) => a.originalNumber - b.originalNumber);

            if (mistakesOrSkips.length > 0 || rememberItems.length > 0) {
                downloadPdfButton.classList.remove('hidden');
            } else {
                downloadPdfButton.classList.add('hidden');
            }

            // Always show the Export All button on the final screen
            exportAllPdfButton.classList.remove('hidden');
        }

        function displayRandomQuote() {
            // Only display quote if game is in progress
            if (gameInProgress) {
                const randomIndex = Math.floor(Math.random() * quotes.length);
                currentQuoteElement.textContent = quotes[randomIndex];
                quoteAreaElement.classList.remove('hidden');
            } else {
                quoteAreaElement.classList.add('hidden'); // Hide if not in game
            }
        }

        // --- PDF Generation Functions using html2pdf.js ---

        // Helper function to generate the HTML content for a single item in the PDF
        function buildItemHtml(item, index, isReview = true) {
            // Common CSS styles for PDF content
            const pdfStyles = `
                <style>
                    body { font-family: 'Arial', sans-serif; line-height: 1.5; color: #333; margin: 0; padding: 0; }
                    p { margin: 0 0 8px 0; }
                    strong { font-weight: bold; }
                    ul { margin: 8px 0 8px 20px; padding: 0; list-style: none; }
                    li { margin-bottom: 4px; font-size: 15pt; } /* Set font size for options list items */
                    .item-container { border: 1px solid #eee; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
                    .item-header { font-size: 11pt; font-weight: bold; margin-bottom: 10px; color: #444; }
                    .question-text { font-size: 16pt; margin-bottom: 8px; } /* Set font size for question text */
                    .answer-text { font-size: 15pt; } /* Set font size for answer text */
                    .correct-answer { color: #28a745; }
                    .incorrect-answer { color: #dc3545; }
                    .skipped-answer { color: #6c757d; font-style: italic; }
                    .explanation-text { font-size: 14pt; color: #1b5e20; margin-top: 8px; } /* Set font size for explanation */
                    /* Basic sub/sup styling */
                    sub, sup { font-size: 0.7em; line-height: 0; position: relative; vertical-align: baseline; }
                    sup { top: -0.5em; }
                    sub { bottom: -0.2em; }
                </style>
            `;

            let itemHtml = `<div class="item-container">`;

            if (isReview) {
                 // Review PDF includes item number and original question number
                 // Check if it's a remembered item or an attempt (incorrect/skipped)
                if (item.isRememberedItem) {
                    // --- Display for Remembered Item ---
                    itemHtml += `<p class="item-header">Item ${index + 1}: (Original Question ${item.originalNumber})</p>`;
                    // Use 'question' property from the original question object
                    itemHtml += `<p class="question-text"><strong>Question:</strong> ${item.question}</p>`;

                     // For remembered items, show the options list
                    if (item.options && Array.isArray(item.options) && item.options.length > 0) {
                         itemHtml += `<p style="margin-bottom: 5px;"><strong>Options:</strong></p><ul>`;
                         item.options.forEach((opt, idx) => {
                             itemHtml += `<li>${String.fromCharCode(97 + idx)}) ${opt}</li>`;
                         });
                         itemHtml += `</ul>`;
                    }

                    // Use 'correctAnswerText' from the original question object
                    itemHtml += `<p class="answer-text correct-answer"><strong>Correct Answer:</strong> ${item.correctAnswerText}</p>`;

                    // Use 'explanation' from the original question object
                    itemHtml += `<p class="explanation-text"><strong>Explanation:</strong> ${item.explanation}</p>`;

                } else {
                     // --- Display for Incorrect/Skipped Attempt ---
                    itemHtml += `<p class="item-header">Item ${index + 1}: (Original Question ${item.originalNumber})</p>`;
                    // Use 'questionText' property from the attempt object
                    itemHtml += `<p class="question-text"><strong>Question:</strong> ${item.questionText}</p>`;

                    // Add selected/skipped answer or action
                    if (item.selectedAnswer === "[Skipped]") {
                        itemHtml += `<p class="answer-text skipped-answer"><strong>Your Action:</strong> [Skipped / Don't Know]</p>`;
                    } else { // Must be an incorrect answer
                        // Use 'selectedAnswer' property from the attempt object
                        itemHtml += `<p class="answer-text incorrect-answer"><strong>Your Answer:</strong> ${item.selectedAnswer}</p>`;
                    }

                    // Use 'correctAnswerText' property from the attempt object
                    itemHtml += `<p class="answer-text correct-answer"><strong>Correct Answer:</strong> ${item.correctAnswerText}</p>`;

                    // Use 'explanation' property from the attempt object
                    itemHtml += `<p class="explanation-text"><strong>Explanation:</strong> ${item.explanation}</p>`;
                }


            } else {
                 // --- Display for All Questions (Not Review) ---
                 // item here is the original question object from allQuestions
                 itemHtml += `<p class="item-header">Question ${item.originalNumber}:</p>`;
                 itemHtml += `<p class="question-text"><strong>Question:</strong> ${item.question}</p>`; // Use item.question

                 // Add options list
                 if (item.options && Array.isArray(item.options) && item.options.length > 0) {
                      itemHtml += `<p style="margin-bottom: 5px;"><strong>Options:</strong></p><ul>`;
                      item.options.forEach((opt, idx) => {
                          // Use item.options
                          itemHtml += `<li>${String.fromCharCode(97 + idx)}) ${opt}</li>`;
                      });
                      itemHtml += `</ul>`;
                 }

                 // Add correct answer
                 // Use item.correctAnswerText
                 itemHtml += `<p class="answer-text correct-answer"><strong>Correct Answer:</strong> ${item.correctAnswerText}</p>`;

                 // Add explanation
                 // Use item.explanation
                 itemHtml += `<p class="explanation-text"><strong>Explanation:</strong> ${item.explanation}</p>`;
            }

            itemHtml += `</div>`; // Close item-container

            // Note: pdfStyles is included multiple times, once for each item.
            // html2pdf handles this, but for cleaner HTML source in the generated PDF,
            // one might build the full HTML string and prepend styles once.
            // However, including it per item is safer if html2pdf processes items
            // somewhat independently or across page breaks. Sticking to including it here.
             return pdfStyles + itemHtml; // Include styles with each item for safety in html2pdf rendering
        }


        // PDF Generation Function for Mistakes, Skips, and Remembered Items using html2pdf.js
        function generateReviewPDF() {
             // Filter includes items where isCorrect is false (incorrect/skipped)
            const mistakesOrSkips = lessonAttempts
                .filter(attempt => !attempt.isCorrect)
                .sort((a, b) => a.originalNumber - b.originalNumber); // Sort by original question number

            const rememberItems = questionsToRemember.sort((a, b) => a.originalNumber - b.originalNumber);

            if (mistakesOrSkips.length === 0 && rememberItems.length === 0) {
                alert("No mistakes, skips, or items added to the 'Remember' list to review.");
                return;
            }

            const topicName = currentTopicQuestions.length > 0 ? currentTopicQuestions[0].topic : 'Lesson';

            let pdfHtml = `
                <html>
                <head>
                    <title>${topicName} Review</title>
                    <style>
                         body { font-family: 'Arial', sans-serif; line-height: 1.4; color: #333; margin: 0; padding: 20mm; }
                         h1, h2 { color: #1a2a6c; }
                         h1 { font-size: 18pt; margin-bottom: 5mm; }
                         h2 { font-size: 14pt; margin-bottom: 8mm; } /* Adjusted margin */
                         p { margin: 0 0 8px 0; }
                         strong { font-weight: bold; }
                         ul { margin: 8px 0 8px 20px; padding: 0; list-style: none; }
                         li { margin-bottom: 4px; } /* Font size handled in buildItemHtml */
                         .item-container { border: 1px solid #eee; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
                         .item-header { font-size: 11pt; font-weight: bold; margin-bottom: 10px; color: #444; }
                         /* Font sizes for question/answer/explanation handled in buildItemHtml */

                         /* Basic sub/sup styling */
                         sub, sup { font-size: 0.7em; line-height: 0; position: relative; vertical-align: baseline; }
                         sup { top: -0.5em; }
                         sub { bottom: -0.2em; }

                         /* Section Titles */
                         .section-title { font-size: 16pt; font-weight: bold; margin-top: 15mm; margin-bottom: 8mm; } /* Adjusted margin */
                         .section-title.mistakes { color: #dc3545; }
                         .section-title.remember { color: #4a69bd; }

                    </style>
                </head>
                <body>
                    <h1>Review - Mistakes, Skips, and Remembered Items</h1>
                    <h2>Lesson: ${topicName}</h2>
                    <p><strong>Final Score:</strong> ${score} / ${currentTopicQuestions.length}</p>
            `;

            // --- Incorrect Answers & Skips Section ---
            if (mistakesOrSkips.length > 0) {
                pdfHtml += `<h2 class="section-title mistakes">Incorrect Answers & Skips (${mistakesOrSkips.length})</h2>`;
                mistakesOrSkips.forEach((item, index) => {
                    pdfHtml += buildItemHtml(item, index, true); // true for isReview
                });
            }

            // --- Questions to Remember Section ---
            if (rememberItems.length > 0) {
                 // Add a little space before this section if the previous one exists
                 if (mistakesOrSkips.length > 0) {
                     pdfHtml += `<div style="height: 10mm;"></div>`; // Add vertical space
                 }
                pdfHtml += `<h2 class="section-title remember">Questions to Remember (${rememberItems.length})</h2>`;
                rememberItems.forEach((item, index) => {
                     // For remembered items, use buildItemHtml in review mode
                    pdfHtml += buildItemHtml(item, index, true); // true for isReview
                });
            }

            pdfHtml += `</body></html>`;

            // Use html2pdf.js to generate and save the PDF
            const worker = html2pdf().from(pdfHtml).set({
                margin: 15, // Page margins in mm
                filename: `${topicName.replace(/[^a-z0-9]/gi, '_')}_Review.pdf`,
				pagebreak:{mode:"avoid-all"}, // Use avoid-all to prevent breaking items/sections
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: {
                    scale: 8, // Increased scale for better resolution (kept from previous fix)
                    logging: true,
                    dpi: 300,
                    letterRendering: true
                },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            });

             worker.save();
        }


        // PDF Generation Function for ALL Questions using html2pdf.js
        function generateAllQuestionsPDF() {
             if (currentTopicQuestions.length === 0) {
                alert("No questions available for the current lesson.");
                return;
            }

            const topicName = currentTopicQuestions.length > 0 ? currentTopicQuestions[0].topic : 'Lesson';

            let pdfHtml = `
                <html>
                <head>
                    <title>${topicName} All Questions</title>
                     <style>
                         body { font-family: 'Arial', sans-serif; line-height: 1.4; color: #333; margin: 0; padding: 20mm; }
                         h1, h2 { color: #1a2a6c; }
                         h1 { font-size: 18pt; margin-bottom: 5mm; }
                         h2 { font-size: 14pt; margin-bottom: 10mm; }
                         p { margin: 0 0 8px 0; }
                         strong { font-weight: bold; }
                         ul { margin: 8px 0 8px 20px; padding: 0; list-style: none; }
                         li { margin-bottom: 4px; } /* Font size handled in buildItemHtml */
                         .item-container { border: 1px solid #eee; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
                         .item-header { font-size: 11pt; font-weight: bold; margin-bottom: 10px; color: #444; }
                         /* Font sizes for question/answer/explanation handled in buildItemHtml */

                         /* Basic sub/sup styling */
                         sub, sup { font-size: 0.7em; line-height: 0; position: relative; vertical-align: baseline; }
                         sup { top: -0.5em; }
                         sub { bottom: -0.2em; }
                    </style>
                </head>
                <body>
                    <h1>All Questions and Answers</h1>
                    <h2>Lesson: ${topicName}</h2>
            `;

             // Sort questions just in case they weren't filtered/sorted earlier (though startGame does this)
             const sortedQuestions = currentTopicQuestions.slice().sort((a, b) => a.originalNumber - b.originalNumber);

            // Add each question to the HTML
             sortedQuestions.forEach((item, index) => {
                pdfHtml += buildItemHtml(item, index, false); // false for not isReview (i.e., show options)
            });

            pdfHtml += `</body></html>`;


            // Use html2pdf.js to generate and save the PDF
             const worker = html2pdf().from(pdfHtml).set({
                margin: 15, // Page margins in mm
                filename: `${topicName.replace(/[^a-z0-9]/gi, '_')}_All_Questions_and_Answers.pdf`,
                 image: { type: 'jpeg', quality: 0.98 },
				 pagebreak:{mode:"avoid-all"}, // Use avoid-all to prevent breaking items
                 html2canvas: {
                     scale: 8, // Increased scale for better resolution (kept from previous fix)
                     logging: true,
                     dpi: 300,
                     letterRendering: true
                    },
                 jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            });

             worker.save();
        }


        // --- Event Listeners ---
        addToRememberButton.addEventListener('click', addToRememberList);
        skipButton.addEventListener('click', skipQuestion);
        nextButton.addEventListener('click', nextQuestion);
        restartButton.addEventListener('click', showLessonSelection);
        downloadPdfButton.addEventListener('click', generateReviewPDF); // Hook up to the new Review PDF function
        exportAllPdfButton.addEventListener('click', generateAllQuestionsPDF);


        // --- Initial Call to Show Lesson Selection ---
        // Using DOMContentLoaded ensures the script runs after the HTML is fully parsed
        document.addEventListener('DOMContentLoaded', showLessonSelection);
    </script>

</body>

</html>
